<!DOCTYPE html>
<html>
<head>
    <title>42 for life</title>
</head>
<body>
    <h2>Search the IT Job Database:<br></h2>
    <h5>
        Example: "Java Linux Cloud" use space as a separator.<br>
    </h5>
    <form method="POST" action="/process_keywords">
        <label for="keywords">Your keywords:</label>
        <input type="text" id="keywords" name="keywords" required><br><br>
        <input type="submit" value="Submit">
    </form>

        <!-- Display area for the returned data -->
        <div id="result-container"></div>

        <!-- JavaScript to handle the display of returned data -->
        <script>
            // Function to display the returned data
            function displayKeywords(keywords) {
                const resultContainer = document.getElementById('result-container');

                if (keywords.length === 0) {
                    resultContainer.innerHTML = `<p>No keywords found.</p>`;
                    return;
                }

                // Create an array of formatted strings for each dictionary
                const formattedKeywords = keywords.map((dict) => {
                    const [name, link] = Object.entries(dict)[0]; // Assuming each dictionary has only one key-value pair
                    return `${name}: <a href="${link}" target="_blank">click here</a>`;
                });

                // Join the formatted strings with line breaks
                const resultHTML = `<p>Job Listings that match one of the keywords:<br>${formattedKeywords.join('<br>')}</p>`;

                // Display the formatted data in the result container
                resultContainer.innerHTML = resultHTML;
            }

            // Example of how to fetch and display data after form submission (using fetch)
            document.querySelector('form').addEventListener('submit', function (event) {
                event.preventDefault(); // Prevent the form from submitting in the traditional way

                // Get the keywords from the form input
                const keywords = document.getElementById('keywords').value;

                // Send a POST request to your Flask endpoint
                fetch('/process_keywords', {
                    method: 'POST',
                    body: new URLSearchParams({ keywords }), // Send keywords as form data
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                })
                .then((response) => response.json()) // Assuming the response is JSON
                .then((data) => {
                    // Display the returned data
                    displayKeywords(data);
                })
                .catch((error) => {
                    console.error('Error:', error);
                });
            });
        </script>
</body>
</html>
